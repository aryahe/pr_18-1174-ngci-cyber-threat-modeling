# 1 介绍
&emsp;&emsp; 本报告提供了对网络威胁建模框架的调查，对所调查的框架进行了比较评估，并扩展了现有框架用以作为各种目的的网络威胁建模的基础。<br>
&emsp;&emsp; 本报告中的工作是由美国国土安全部（DHS）科技局（S＆T）下一代网络基础设施（NGCI）Apex计划执行的。该计划旨在加快金融服务部门（FSS） 采取有效的缓解信息技术安全风险的网络技术。但是，尽管NGCI Apex计划专注于FSS，但网络威胁建模也可以广泛地适用于其他关键基础设施领域的中到大型组织；它也适用于个别组织之外。因此，本报告可作为非军事用途的普遍资源。

[^1]:加拿大贝尔和Sphyrna Security为加拿大国防研究与发展部（DRDC）准备了一份用于军事目的的网络威胁建模方面的最新研究报告[Magar 2016]。该报告中开发的框架在第2节中进行了讨论。

 <br>
&emsp;&emsp; 网络威胁建模是在网络空间中开发和应用对抗性威胁（源、场景和特定事件）描述的过程。此类威胁可能针对或影响设备、应用程序、系统、网络、重要任务或业务功能（以及支持该任务或业务功能的系统）、组织、区域或关键基础设施部门。网络威胁建模过程可以通过多种方式为与网络安全和弹性相关的工作提供信息：<br>

- 风险管理。网络威胁建模是网络风险框架、分析和评估以及替代应对评估（单独或在网络安全项目组合管理的背景下）的组成部分，而这些都是企业风险管理的组成部分。尽管在风险管理中可以（也必须）考虑非对抗性威胁，但本文重点关注网络安全和弹性的对抗性威胁模型。参见第1.2.1节。
- 网络作战。网络威胁建模是网络战争威胁情景开发的动机和基础。在这种情况下，网络威胁建模对参与或代表战争活动的利益相关者具有很强的针对性。参见第1.2.2节。
- 技术分析和寻觅。网络威胁建模可以促使通过选择威胁事件或威胁场景，以评估和比较技术、产品、服务的功能。也就是说，网络威胁建模可以通过技术分析，描述现有技术并识别研究差距。其还可以支持技术搜寻，即搜寻和识别潜在兴趣技术的过程。参见第1.2.3节。
- 系统安全工程。网络威胁建模可在整个系统开发生命周期（SDLC）中使用，包括需求定义、分析和设计、实施、测试以及运维（O＆M）。然而，其对于设计分析和测试尤其重要，因为它会激发用于设计与测试设备、应用程序、及/或系统的威胁情景的开发并为其奠定基础[Kosten 2017]。因此，网络威胁建模可以面向概念分层体系结构中的特定层或一组层。尽管此目的不是此调查的主要重点，但针对此目的的一些网络威胁建模框架和方法也包含在调查中。
- 安全操作和分析。网络威胁建模可以将网络防御者的活动集中在特定类型的威胁事件上，包括威胁搜寻（搜索对手活动的指标或证据），持续监控和安全评估以及DevOps（防御工具的快速开发和操作部署）。为此，威胁信息共享至关重要。要共享威胁信息，需要对构成此类信息的概念有一个共同的认识，即哪些信息是相关且有用的[NIST 2016c]。调查中包含一些针对此目的的网络威胁建模框架和方法。

&emsp;&emsp; 网络威胁建模的过程涉及选择一个网络威胁建模框架，并在该框架中填充与预期范围（例如架构层或利益相关者关注点）相关的特定值（例如，对手专业知识，攻击模式和攻击事件）。填充的框架可用于构建威胁情景（用于风险评估、网络作战、设计分析和测试）；特征控制、技术或研究工作（用于技术搜寻）；以及/或共享威胁信息和响应。<br>
&emsp;&emsp; 本简介部分介绍了关键概念和术语，讨论了网络威胁建模的一些用法，并提供了用于编写此报告的调查和评估过程的背景信息。第2节概述了网络威胁建模框架和方法。第3节介绍了部分填充的网络威胁模型或子模型。图1说明了以下事实：网络威胁建模框架和方法已作为风险框架和建模方法的一部分，作为面向企业信息技术（EIT）和非EIT环境的网络威胁建模的通用方法。该图提供了第2节和第3节中调查的建模框架。第4节介绍了与NGCI Apex计划目标相关的调查材料的分析和评估。第5节提供了初始且部分填充的网络威胁建模框架，供NGCI Apex计划使用，该框架也可能具有更广泛的用途。附录A说明了相关的威胁建模架构。最后，提供了词汇表，首字母缩写词列表和参考文献。<br>

<div align=center><img src="https://github.com/aryahe/pr_18-1174-ngci-cyber-threat-modeling/blob/main/%E5%9B%BE1.%E5%A8%81%E8%83%81%E6%A8%A1%E5%9E%8B%E6%98%AF%E4%BB%8E%E5%A4%9A%E7%A7%8D%E8%A7%92%E5%BA%A6%E5%BC%80%E5%8F%91%E7%9A%84.jpg" alt="图1.威胁模型是从多种角度开发的" title="图1.威胁模型是从多种角度开发的" width=600></div>

## 1.1关键概念和术语

&emsp;&emsp; 模型是对某些领域里人类经验的抽象表示，通常被用于（1）构建知识，（2）提供用于讨论该知识的通用语言，以及（3）在该领域中进行分析。<br>

&emsp;&emsp; 威胁建模中使用了各种术语，包括威胁、威胁行动者、威胁事件、威胁载体、威胁场景、战役、攻击者、攻击、攻击向量、攻击活动、恶意网络活动和入侵。基于对使用它们的上下文和目的的假设，不同的威胁建模方法对这些术语的定义有所不同。与威胁有关的术语已被嵌入到有关风险的更大集合的术语中。因此，定义取决于对风险的更深入了解，以及对将在其中管理风险的技术和运营环境的假设。<br>

&emsp;&emsp; 至少有几个概念是关键。这些概念与不良事件有关；可能导致这些事件发生的驱动力或行动者；或有关一个或多个不良事件如何造成伤害的故事或结构化描述；以及可能造成的危害。通常，与这些概念相对应的术语是威胁事件、威胁源、威胁场景和后果。对于NGCI Apex计划，重点是[OFR 2017]所定义的网络攻击：“网络攻击是故意破坏、窃取、更改或破坏IT系统上存储的数据。”<br>

&emsp;&emsp; 联邦金融机构审查委员会（FFIEC）信息安全（IS）风险评估手册  [FFIEC 2016]将威胁定义为事件：<br>
*威胁是指可能由于未经授权的披露、滥用、更改或破坏信息或信息系统而损害信息或信息系统的机密性，完整性或可用性的事件。*<br>

&emsp;&emsp; 但是，术语“威胁”也视情况被更广泛地使用及修改其他术语。<br>

&emsp;&emsp; 美国国家标准技术研究院（NIST）在NIST特殊出版物（SP） 800-30R1中发布了风险评估指南[NIST 2012]。 NIST SP 800-30R1定义了与威胁有关的几个术语：
威胁：任何通过未经授权的访问、破坏、披露或修改而对组织运营（包括重要任务，职能，形象或声誉），组织资产、个人、其他组织或国家产生不利影响，和/或拒绝服务影响的情况或事件。<br>

*威胁事件： 可能导致不良后果或影响的事件或情况。*<br>
*威胁场景： 与特定威胁源或多个威胁源关联的一组离散威胁事件，部分情况下有时间序列。威胁战争的同义词。*<br>

&emsp;&emsp; 在《FFIEC IS手册》中，威胁来自内部或外部的向量（在其他参考文献中称为威胁参与者或对手）。其具有不同的功能和动机，因此需要使用不同的风险缓解和控制技术。请注意，此特征（与NIST SP 800-30R1中提供的特征不同）并未考虑来自民族国家的威胁，这些威胁可能寻求竞争情报，但也可能结合其他国际冲突，试图以危害国家安全的方式非法或公开地造成损害。<br>

&emsp;&emsp; NIST SP 800-30R1识别四种威胁源：对抗性、偶然性、结构性和环境相关的。在表D-2中， NIST SP 800-30R1将对抗性威胁（即威胁参与者）描述为：<br>
*试图利用组织对网络资源（即电子形式的信息、信息和通信技术以及这些技术提供的通信和信息处理能力）的依赖的个人，团体，组织或州。*<br>

&emsp;&emsp; 对抗性威胁包含两个主要方面：特征（例如能力、意图和目标[NIST 2012]）和行为（通常称为恶意网络活动[NSTC 2016]或攻击活动）。与能力有关的对手特征可以包括可指导或分配的方法资源以及关系[Bodeau 2013]。意图可以具有多个方面：（i）网络目标或预期的网络影响（例如，拒绝服务、数据修改），（ii） 非网络目标（例如，财务收益），以及（iii）风险权衡[Bodeau 2014]。行为可以描述为战术、技术和规程（TTP） ：<br>

“战术是对行为的高级描述，技术是对战术上下文中行为的详细描述，而过程是对技术上下文而言较低级别的，高度详细的描述。TTP可以描述使用行为的倾向，如特定的恶意软件变体、操作顺序、攻击工具、分发机制（如网络钓鱼或水坑攻击）或利用。” [NIST 2016c]<br>

&emsp; &emsp; FFIEC IS手册和NIST SP 800-30R1定义都特别列举了（网络）威胁可能对信息和信息系统造成影响的后果类型。这些网络影响，无论是表示为失去机密性，完整性或可用性，还是使用更为细致的词汇表述[Temin 2010]，都可以转化为以下影响：组织；其客户、合作伙伴或供应商；其部门；组织内部或整个部门的重要任务或业务职能；或国家。<br>

*对抗性威胁参与者的行为或行动可以根据他们使用的威胁向量（或攻击向量）来描述：*<br>

*攻击向量或攻击途径是达到网络影响的通用方法，可以包括网络、物理或动能、社会工程和供应链攻击。 [Bodeau 2014]*<br>

&emsp;&emsp; 攻击向量受到有关攻击发生的技术和操作环境的基础模型或假设集的强烈影响。因此，通常在事件处理[NIST 2012b]或漏洞修复[FIRST 2015]中枚举攻击向量。<br>

&emsp;&emsp; 可以使用网络攻击生命周期或网络杀伤链模型将对手的对抗行为组织到威胁场景或攻击场景中。目前已经有许多此类模型的变体。例如洛克希德·马丁公司的网络杀伤链[Cloppert 2009]和NIST SP 800-30R1中给出的威胁战役的架构。有关网络攻击生命周期模型的讨论，请参见第2.1.6.3节。威胁情景可以以图形方式（如攻击图）或使用树结构（如攻击树）以及口头方式（例如在演习中）表示。<br>

## 1.2威胁建模的用途

&emsp;&emsp; 如前所述，网络威胁建模可以满足多种目的。其中有三个目的与NGCI Apex计划特别相关：输入风险指标的定义和评估，以支持风险管理；构建用于网络作战的威胁情景；和技术搜寻。这些将在下文中讨论。<br>

### 1.2.1 风险管理和风险指标

&emsp;&emsp; 风险管理可以描述四个组成过程：风险框架、风险评估、风险响应和风险监控 [NIST 2011]。风险框架包括陈述相关风险管理的环境的假设，并定义风险管理策略（例如，如何考虑替代性风险缓解措施的优先级–其属于网络安全解决方案组合中的内容）。关于威胁源（尤其是攻击者特征）的假设对于风险框架至关重要，而威胁事件的特征或分类法可以用于网络安全组合管理。风险评估将威胁模型的所有方面与环境模型（如关于可能发生威胁的运营和技术环境的描述）结合在一起，以便可以估算或评估威胁情景或单个威胁事件的可能性和后果严重性。风险响应包括评估潜在的替代风险缓解措施（减少后果的可能性和严重性的方法），因此重点关注威胁事件和威胁模型的威胁场景部分。风险监测涉及寻找环境变化的迹象，特别是在进行持续监测和安全评估的系统内的对手活动的指标；虽然风险监控的部分侧重于系统威胁事件并依赖于威胁信息共享，但更高级别的情报分析寻找对手特征的变化，并将其反馈到风险框架和风险评估中。<br>

&emsp;&emsp; 网络安全风险可以在不同的范围内进行管理。在组织内，可以在组织层（或执行层），任务/业务功能层（或业务流程层）和信息系统层（或实施/操作层）管理风险 [NIST 2011]。除此之外，还可以确定两个附加级别：部门、地区或利益相关方（COI）层，以及国家或跨国级别[Bodeau 2014]。这些如图2所示。 <br>

<div align=center><img src="https://github.com/aryahe/pr_18-1174-ngci-cyber-threat-modeling/blob/main/%E5%9B%BE2.%E5%A8%81%E8%83%81%E6%A8%A1%E5%9E%8B%E6%94%AF%E6%8C%81%E7%9A%84%E9%A3%8E%E9%99%A9%E7%AE%A1%E7%90%86%E5%86%B3%E7%AD%96%E8%8C%83%E5%9B%B4.jpg" alt="图2.威胁模型支持的风险管理决策范围.jpg" title="图2.威胁模型支持的风险管理决策范围.jpg" width=400></div>

&emsp;&emsp; 威胁模型可以针对以下一个或多个级别：<br>

- 系统实施或操作级别，威胁模型（或由威胁模型构成的威胁情报）可以促使人们选择特定的安全控制措施或采取行动。根据SDLC中的阶段，威胁模型可以指导设计决策或安全操作。
- 在任务或业务功能级别，威胁模型可以促进企业架构、组织信息安全架构，以及特定任务或业务功能架构相关的因素。
- 在组织级别，威胁模型反映并表达了组织对其威胁环境的假设；这些是组织风险框架不可或缺的一部分[NIST 2011]。请注意，组织级别的风险管理不仅可以考虑其组织的网络资源，还可包含从服务提供商那里获得的资源（例如，网络电信、云服务、托管安全服务）。例如，组织与云提供商的服务水平协议（SLA）可以基于共享或组织定义的威胁模型。
- 在企业之上的级别，威胁模型可以提供威胁情报信息共享的通用结构，并且可以支持多参与者演习或网络战争游戏的开发。

&emsp;&emsp; 在《网络保险购买指南》 [FSSCC 2016]的“采购要求”附录中指出，威胁模型应作为提供可连接网络的软件、系统或设备的供应商交付的风险评估成果的一部分。<br>

&emsp;&emsp; 风险评估的威胁建模可以从三个方向进行：对威胁进行一般或专门的建模，然后将其应用于相关环境；对环境中的系统、数据和边界建模，然后确定相关的威胁；或先确定可能受到威胁影响的组织资产，对可能影响或针对这些资产的威胁进行描述，确定可能影响或针对这些资产的威胁的特征，再根据系统对资产进行定位[Potteiger 2016] [NIST 2016]。这三种方法在图3中进行了说明。请注意，虽然每种方法都将风险的不同方面作为起点，但对其他方面的假设被隐式地用于确定主要方面的范围。<br>

<div align=center><img src="https://github.com/aryahe/pr_18-1174-ngci-cyber-threat-modeling/blob/main/%E5%9B%BE3.%E5%A8%81%E8%83%81%E5%BB%BA%E6%A8%A1%E6%96%B9%E6%B3%95.jpg" alt="图3.威胁建模方法.jpg" title="图3.威胁建模方法.jpg" width=400></div>

&emsp;&emsp; 使用这些威胁建模方法中的任何一种，都可以在相关漏洞和环境假设的背景下，通过评估已识别的威胁事件或场景来评估风险，以估算发生的可能性和影响的严重性。由此产生的风险测量是任何固有风险的结果，减去实施的控制所提供的威胁缓解，即剩余风险的测量。随着其他控制措施的确定和实施，以及不断演变的威胁能力的确定和报告，该过程可能会反复进行。<br>

&emsp;&emsp; 测量风险水平、确定支持持续进行的网络威胁缓解的操作流程，应会产生针对基于重要风险指标的报告能力。<br>

&emsp;&emsp; 指标的开发不在本文档的范围之内，但是风险指标对于为执行经理提供监督能力以建立网络程序基线，用于管理机构可接受的残留风险至关重要。<br>

### 1.2.2 网络兵器推演

&emsp;&emsp; 网络兵器推演是一种在模拟环境中，在网络攻击场景下锻炼和检查人员操作和决策，或系统特征和结果的方法。示例包括桌面演习、红队演习以及桌面和红队演习的混合组合。红队和混合演习可以模拟操作系统、网络范围、测试平台或实验室中的攻击和防御活动。建模和仿真（M＆S）可用于开发网络战争游戏的场景，或支持混合演习和仿真实验（SIMEX， [MITRE 2009]） 。<br>

&emsp;&emsp; 网络威胁模型通过创建由红队扮演的对抗配置（或者桌面演习脚本、或者作为M＆S中的一组参数）来支持网络作战，用以识别可能的威胁事件并制定威胁情景。<br>

### 1.2.3 技术分析和技术搜寻

&emsp;&emsp; 网络安全控制、技术和实践有助于缓释风险。任何组织都受到资源的限制，因此无法实施所有可能的风险缓解措施。可以根据要解决的威胁（通常是威胁事件的类型）以及使用其他结构化的框架来描述潜在的风险缓解措施。威胁模型，包含对手特征和典型行为的书面概要，在已发表的研究与开发（R＆D）工作描述中很常见。如基于国家信息保障伙伴关系（NIAP） 的CC标准评估产品时，其安全配置或者安全目标中的安全问题定义部分中，会包含更细节的安全模型（包括系列安全事件）。 <br>

&emsp;&emsp; 为了支持技术搜寻，可以使用诸如矩阵之类的分类方法。通过将风险缓解措施和威胁事件放置在此类矩阵的单元中，分析人员可以就缓解措施的影响提出可检验的假设。如某种结构化框架部分源自于NIST网络安全框架（CSF， [NIST 2014]），详见第2.1.1节。在Cyber Apex审核小组（CART）使用的“网络防御矩阵”中，如图4所示，技术和产品被映射到由CSF（列）所定义的五个功能，以及其这些功能所涉及的资产类别（行）。例如，网络检测单元位于检测功能和网络资产类别的交集。其对CART的网络防御矩阵进行了详细的说明，而在某些情况下，会为功能-资产映射表中未能直接映射的区域添加额外的单元格。特别是，单元格有时用于分析和可视化以及编制和自动化。CART已经确定了FSS特别感兴趣的四个单元：网络识别，网络检测，数据保护和数据检测。<br>

<div align=center><img src="hhttps://github.com/aryahe/pr_18-1174-ngci-cyber-threat-modeling/blob/main/%E5%9B%BE4.%E7%BD%91%E7%BB%9C%E9%98%B2%E5%BE%A1%E7%9F%A9%E9%98%B5.jpg" alt="图4.网络防御矩阵.jpg" title="图4.网络防御矩阵.jpg" width=400></div>

&emsp;&emsp; 由于可以根据威胁影响的资产类型来表征威胁，因此可以将“网络防御矩阵”中的单元格视为描述特定风险缓解措施可能对威胁产生的影响类型。<br>

&emsp;&emsp; 美国网络后果部门（US-CCU）提供了两个相关的矩阵[Borg 2016]。一个矩阵根据攻击者的攻击行动（列）和利用漏洞的资产类型（行）来描述漏洞（可用于描述特定的攻击者活动）。攻击者的攻击行动包括查找、渗透、吸收、隐瞒和不可逆转的操作（请注意，攻击行为的这种分类实际上是网络攻击的生命周期。）资产类型包括硬件、软件、网络、自动化、用户和供应商。第二个矩阵，依据其对每种资产的对手目标的影响（如更难发现、更难以渗透）来描述风险缓释的特点。<br>

&emsp;&emsp; 另一种矩阵方法是根据Lockheed-Martin网络杀伤链（行）和国防部（DoD）对军事对手（列）的影响描述风险缓释。这些影响包括发现、拒绝、破坏、退化、欺骗和破坏[Cloppert 2009，Bedell 2016]。相比之下，由互联网安全中心(CIS)开发的社区攻击模型使用了一个矩阵，其中行对应CSF功能，但列对应网络攻击生命周期中的9个攻击阶段[CIS 2016];CIS关键安全控制被映射到该矩阵中的单元格。<br>

## 1.3 调查评估方法

&emsp;&emsp; MITRE，NGCI Apex计划和CART中的主题专家们（SMEs）确定了第2节和第3节中描述的框架和模型集。主题专家们（SMEs）确定了一些针对国防部或其他军事组织的威胁建模方法，这些方法可能与FSS有关，并被用作调查的输入。评估是由NGCI Apex所确定的网络威胁模型的预期用途范围驱动进行的，这些模型包括：风险管理、组织内部以及跨部门或子部门的网络作战、技术搜寻和技术评估。<br>

&emsp;&emsp; 由于FSS严重依赖于此，因此调查和评估的重点是针对或利用企业IT的网络威胁。然而，其他关键基础设施部门严重依赖于运营技术（OT）。甚至FSS中的组织也依赖或将越来越依赖于网络物理系统（CPS），例如自动柜员机（ATM）和OT。例如， EIT与建筑物访问和控制系统（BACS）之间的融合可以提高效率并降低运营成本。针对CPS，OT和物联网（IoT）的网络威胁建模也是未来工作的领域。<br>
